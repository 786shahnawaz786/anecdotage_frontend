(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{388:function(t,e,o){"use strict";o.r(e);o(17),o(15),o(11),o(24),o(25);var n=o(6),r=o(1);o(5),o(35),o(66),o(50);function d(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?d(Object(o),!0).forEach((function(e){Object(n.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var l={data:function(){return{books:[],isModalVisible:!1,inputText:"",selectedBook:null,selectedFormat:"",isDownloading:!1,retryAttempts:0,maxRetryAttempts:3}},mounted:function(){this.fetchBooks()},methods:{fetchBooks:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://anecdotage.com/api/books",{headers:{"Content-Type":"application/json"},timeout:1e4});case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("Server error: ".concat(o.status));case 6:return e.next=8,o.json();case 8:if((data=e.sent).books){e.next=11;break}throw new Error("No books data received from server");case 11:t.books=data.books.map((function(t){return c(c({},t),{},{cover_image:t.cover_image||"",author_name:t.author_name||"Unknown Author",main_subject:t.main_subject||"",description:t.description||"",file_attachment_pdf:t.file_attachment_pdf||"",file_attachment_txt:t.file_attachment_txt||"",file_attachment_epub:t.file_attachment_epub||""})})),0===t.books.length&&alert("No books available at the moment."),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error fetching books:",e.t0),t.handleFetchError(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))()},handleFetchError:function(t){this.retryAttempts++;var e=this.retryAttempts<this.maxRetryAttempts?"".concat(t.message,". Attempt ").concat(this.retryAttempts," of ").concat(this.maxRetryAttempts,". Would you like to retry?"):"Maximum retry attempts reached. Please try again later or contact support.";this.retryAttempts<this.maxRetryAttempts?confirm(e)&&this.fetchBooks():alert(e)},formatPublisherDate:function(t){try{if(!t)return"Date unavailable";var e=new Date(t);if(isNaN(e.getTime()))throw new Error("Invalid date");return e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return console.warn("Date formatting error:",t),"Date unavailable"}},showModal:function(t,e){this.selectedBook=t,this.selectedFormat=e,this.isModalVisible=!0,this.inputText=""},closeModal:function(){this.isModalVisible=!1,this.inputText="",this.isDownloading=!1},downloadBook:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.inputText.trim()){e.next=3;break}return alert("Please enter a valid Download Pin or Master Key."),e.abrupt("return");case 3:if(t.isDownloading=!0,e.prev=4,o=t.getDownloadUrl()){e.next=8;break}throw new Error("Invalid download format selected");case 8:return e.next=10,fetch(o,{method:"GET",headers:{"Content-Type":"application/json"},timeout:15e3});case 10:if((n=e.sent).ok){e.next=16;break}return e.next=14,n.json();case 14:throw r=e.sent,new Error(r.error||"Download failed");case 16:return e.next=18,t.handleDownloadSuccess(n);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),t.handleDownloadError(e.t0);case 23:return e.prev=23,t.isDownloading=!1,e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[4,20,23,26]])})))()},getDownloadUrl:function(){var t=this.selectedBook.id,e=this.inputText;return"".concat("https://anecdotage.com/api","/downloadFile/").concat(t,"/").concat(e,"/").concat(this.selectedFormat)},handleDownloadSuccess:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function o(){var n,r,link,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,t.blob();case 3:n=o.sent,r=window.URL.createObjectURL(n),link=document.createElement("a"),d=e.selectedFormat,link.href=r,link.download="".concat(e.selectedBook.title,".").concat(d),document.body.appendChild(link),link.click(),document.body.removeChild(link),window.URL.revokeObjectURL(r),e.closeModal(),o.next=19;break;case 16:o.prev=16,o.t0=o.catch(0),alert("Error processing download: "+o.t0.message);case 19:case"end":return o.stop()}}),o,null,[[0,16]])})))()},handleDownloadError:function(t){console.error("Download error:",t);var e=t.message.includes("timeout")?"Download timed out. Please check your connection and try again.":"Provided pin is invalid";alert(e)},handleImageError:function(t){t.target.src="https://default-image-url.jpg"}}},f=(o(732),o(3)),component=Object(f.a)(l,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._l(t.books,(function(e){return o("div",{key:e.id,staticClass:"card card-m-5"},[o("div",{staticClass:"card-body"},[o("div",{staticClass:"container-fluid"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-xl-2 col-lg-2 col-md-12 col-sm-12"},[o("div",{staticClass:"profile-avatar"},[o("img",{staticClass:"profile-img lazyLoad",attrs:{title:e.title,alt:e.title,src:e.cover_image||"https://default-image-url.jpg"},on:{error:t.handleImageError}})])]),t._v(" "),o("div",{staticClass:"col-xl-9 col-lg-9 col-md-12 col-sm-12 mt-3 book-list"},[o("div",{staticClass:"profile-description"},[o("h2",{staticClass:"profile-name"},[o("span",[t._v("#"+t._s(e.book_number))])]),t._v(" "),o("h3",{staticClass:"profile-title"},[t._v("\n                Explore the World of Books: "+t._s(e.title)+"\n                "),o("span",{staticStyle:{color:"#565959","font-weight":"lighter"}},[t._v("\n                  - "+t._s(t.formatPublisherDate(e.publisher_date))+"\n                ")])]),t._v(" "),o("h5",[t._v("\n                by "),o("span",{staticStyle:{color:"#007185"}},[t._v(t._s(e.author_name||"Unknown Author"))]),t._v(" (Author)\n              ")]),t._v(" "),o("p",{staticClass:"profile-desc"},[t._v(t._s(e.main_subject||"No subject available"))]),t._v(" "),o("p",{staticClass:"profile-desc"},[t._v(t._s(e.description||"No description available"))])]),t._v(" "),o("div",{staticClass:"profile-buttons"},[o("button",{staticClass:"btn btn-sm follow-btn",class:{"disabled-btn":!e.file_attachment_pdf},attrs:{disabled:!e.file_attachment_pdf},on:{click:function(o){return t.showModal(e,"pdf")}}},[t._v("\n                Download PDF\n              ")]),t._v(" "),o("button",{staticClass:"btn btn-sm follow-btn",class:{"disabled-btn":!e.file_attachment_txt},attrs:{disabled:!e.file_attachment_txt},on:{click:function(o){return t.showModal(e,"txt")}}},[t._v("\n                Download TEXT\n              ")]),t._v(" "),o("button",{staticClass:"btn btn-sm follow-btn",class:{"disabled-btn":!e.file_attachment_epub},attrs:{disabled:!e.file_attachment_epub},on:{click:function(o){return t.showModal(e,"epub")}}},[t._v("\n                Download EPUB\n              ")])])])])])])])})),t._v(" "),t.isModalVisible?o("div",{staticClass:"modal",on:{click:t.closeModal}},[o("div",{staticClass:"modal-content",on:{click:function(t){t.stopPropagation()}}},[o("h3",[t._v("Download Book")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],staticClass:"modal-input",attrs:{type:"text",placeholder:"Enter Download Pin or Master Key",disabled:t.isDownloading},domProps:{value:t.inputText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.downloadBook.apply(null,arguments)},input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),t._v(" "),o("button",{staticClass:"btn btn-sm follow-btn",attrs:{disabled:t.isDownloading},on:{click:t.downloadBook}},[t.isDownloading?o("span",[t._v("Downloading...")]):o("span",[t._v("Download Now")])]),t._v(" "),t.isDownloading?o("div",{staticClass:"loader"}):t._e()])]):t._e()],2)}),[],!1,null,"c77f6fd2",null);e.default=component.exports},650:function(t,e,o){var content=o(733);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(8).default)("9ab6528a",content,!0,{sourceMap:!1})},732:function(t,e,o){"use strict";o(650)},733:function(t,e,o){var n=o(7)(!1);n.push([t.i,'.loader[data-v-c77f6fd2]{margin:10px auto;border:8px solid #f3f3f3;border-top-color:#ed7d30;border-radius:50%;width:50px;height:50px;animation:spin-data-v-c77f6fd2 1s linear infinite}@keyframes spin-data-v-c77f6fd2{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.modal[data-v-c77f6fd2]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[data-v-c77f6fd2]{background:#fff;padding:20px;border-radius:8px;width:400px;text-align:center}.modal-input[data-v-c77f6fd2]{width:100%;padding:10px;margin:10px 0;border:1px solid #ddd;border-radius:4px}.modal button[data-v-c77f6fd2]:disabled{background-color:#c56b2f;cursor:not-allowed}.modal button[data-v-c77f6fd2]:hover:not(:disabled){background-color:#c56b2f}.follow-btn[data-v-c77f6fd2]{width:240px;margin-top:12px;background-color:#ed7d30;color:#fff;padding:8px}.disabled-btn[data-v-c77f6fd2]{background-color:#ccc;cursor:not-allowed;opacity:.6}.follow-btn[data-v-c77f6fd2]:not(.disabled-btn):hover{background-color:#c56b2f}.profile-header[data-v-c77f6fd2]{display:flex;align-items:center;margin:10px auto 0}.profile-name[data-v-c77f6fd2]{font-size:36px;font-weight:500;line-height:40px}.profile-name span[data-v-c77f6fd2]{color:#ed7d30}.profile-description[data-v-c77f6fd2]{margin:0}.profile-title[data-v-c77f6fd2]{font-size:24px!important;line-height:32px!important;font-weight:400!important;color:#0f1111;margin-top:0;margin-bottom:6px}.profile-desc[data-v-c77f6fd2],.profile-title[data-v-c77f6fd2]{font-family:"Amazon Ember",Arial,sans-serif}.profile-desc[data-v-c77f6fd2]{font-size:14px;line-height:20px;color:#555;margin-top:6px}.profile-buttons[data-v-c77f6fd2]{padding:10px 0}.profile-img[data-v-c77f6fd2]{width:220px;height:320px;padding:3px;border:2px solid #ed7d30;display:block}@media screen and (max-width:768px){.profile-img[data-v-c77f6fd2]{width:100%;height:auto}.follow-btn[data-v-c77f6fd2]{width:100%;margin-top:12px}}@media screen and (min-width:1300px) and (max-width:1400px){.book-list[data-v-c77f6fd2]{margin-left:16px}}@media screen and (min-width:1200px) and (max-width:1300px){.book-list[data-v-c77f6fd2]{margin-left:32px}}@media screen and (min-width:1100px) and (max-width:1200px){.book-list[data-v-c77f6fd2]{margin-left:48px}}@media screen and (min-width:1050px) and (max-width:1100px){.book-list[data-v-c77f6fd2]{margin-left:64px}}@media screen and (min-width:992px) and (max-width:1050px){.book-list[data-v-c77f6fd2]{margin-left:72px}}@media screen and (max-width:991px){.book-list[data-v-c77f6fd2]{margin-left:0}}',""]),t.exports=n}}]);