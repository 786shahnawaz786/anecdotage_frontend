(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{414:function(t,e,o){"use strict";o.r(e);o(22),o(20),o(29),o(30);var n=o(5),r=o(1),l=(o(6),o(27),o(37),o(100),o(769),o(9),o(60)),c=o.n(l);function d(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function v(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?d(Object(o),!0).forEach((function(e){Object(n.a)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var _={data:function(){return{books:[],showModal:!1,selectedBook:{},showDownloadModal:!1,downloadPin:"",selectedBookId:null,selectedFileType:""}},mounted:function(){this.fetchBooks()},methods:{fetchBooks:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.a.get("https://anecdotage.com/api/books");case 3:o=e.sent,t.books=o.data.books.map((function(t){return v(v({},t),{},{isTitleExpanded:!1,isDescriptionExpanded:!1})})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching books:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},formatDate:function(t){return new Date(t).toLocaleDateString()},truncateText:function(text,t){var e=window.innerWidth<=768?20:t;return text.length>e?text.substring(0,e)+"...":text},toggleReadMore:function(t,e){t["is".concat(e.charAt(0).toUpperCase()+e.slice(1),"Expanded")]=!t["is".concat(e.charAt(0).toUpperCase()+e.slice(1),"Expanded")]},editBook:function(t){this.selectedBook=v({},t),this.selectedBook.publisher_date&&(this.selectedBook.publisher_date=new Date(t.publisher_date).toISOString().split("T")[0]),this.showModal=!0},closeModal:function(){this.showModal=!1},handleCoverImageChange:function(t){var e=t.target.files[0];e&&(this.selectedBook.cover_image=e)},handleFileChange:function(t,e){var o=t.target.files[0];o&&(this.selectedBook["file_attachment_".concat(e)]=o)},updateBook:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o,n,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("title",t.selectedBook.title),o.append("main_subject",t.selectedBook.main_subject),o.append("book_number",t.selectedBook.book_number),o.append("author_name",t.selectedBook.author_name),o.append("publisher_date",t.selectedBook.publisher_date),o.append("DownloadPin",t.selectedBook.DownloadPin),t.selectedBook.cover_image instanceof File&&o.append("cover_image",t.selectedBook.cover_image),t.selectedBook.file_attachment_pdf instanceof File&&o.append("file_attachment_pdf",t.selectedBook.file_attachment_pdf),t.selectedBook.file_attachment_epub instanceof File&&o.append("file_attachment_epub",t.selectedBook.file_attachment_epub),t.selectedBook.file_attachment_txt instanceof File&&o.append("file_attachment_txt",t.selectedBook.file_attachment_txt),e.prev=11,e.next=14,c.a.post("https://anecdotage.com/api/books/".concat(t.selectedBook.id),o,{headers:{"Content-Type":"multipart/form-data"}});case 14:200===(n=e.sent).status&&(r=n.data.book,l=t.books.findIndex((function(t){return t.id===r.id})),t.books.splice(l,1,v(v({},r),{},{isTitleExpanded:!1,isDescriptionExpanded:!1})),t.closeModal()),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),console.error("Error updating book:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[11,18]])})))()},deleteBook:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!confirm("Are you sure you want to delete this book?")){o.next=10;break}return o.prev=1,o.next=4,c.a.delete("https://anecdotage.com/api/books/".concat(t));case 4:e.books=e.books.filter((function(e){return e.id!==t})),o.next=10;break;case 7:o.prev=7,o.t0=o.catch(1),console.error("Error deleting book:",o.t0);case 10:case"end":return o.stop()}}),o,null,[[1,7]])})))()},openDownloadModal:function(t,e){this.selectedBookId=t,this.selectedFileType=e,this.showDownloadModal=!0,this.downloadPin=""},closeDownloadModal:function(){this.showDownloadModal=!1,this.selectedBookId=null,this.selectedFileType=""},downloadBook:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o,n,link;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.downloadPin){e.next=3;break}return alert("Please enter a valid PIN."),e.abrupt("return");case 3:return e.prev=3,e.next=6,c.a.get("https://anecdotage.com/api/downloadFile/".concat(t.selectedBookId,"/").concat(t.downloadPin,"/").concat(t.selectedFileType),{responseType:"blob"});case 6:o=e.sent,n=window.URL.createObjectURL(new Blob([o.data])),(link=document.createElement("a")).href=n,link.setAttribute("download","book.".concat(t.selectedFileType)),document.body.appendChild(link),link.click(),window.URL.revokeObjectURL(n),t.closeDownloadModal(),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),alert("Invalid PIN . Please try again."),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[3,17]])})))()}}},m=(o(770),o(3)),component=Object(m.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"container my-5"},[e("div",{staticClass:"card shadow-lg rounded-lg p-4"},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-4"},[e("h1",{staticClass:"text-left mb-0 ml-4",staticStyle:{"font-size":"50px"}},[t._v("Books")]),t._v(" "),e("nuxt-link",{staticClass:"btn btn-primary btn-lg mr-4",attrs:{to:{name:"books-create"}}},[t._v("\n        Add Books\n      ")])],1),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-striped table-bordered table-hover"},[t._m(0),t._v(" "),e("tbody",t._l(t.books,(function(o){return e("tr",{key:o.id},[e("th",{attrs:{scope:"row"}},[t._v(t._s(o.id))]),t._v(" "),e("td",[o.cover_image?e("img",{staticClass:"img-thumbnail",staticStyle:{"max-width":"100px"},attrs:{src:o.cover_image,alt:"Cover Image"}}):e("span",{staticClass:"text-muted"},[t._v("No Image")])]),t._v(" "),e("td",{staticClass:"text-left"},[o.isTitleExpanded?e("span",[t._v(t._s(o.title))]):e("span",[t._v(t._s(t.truncateText(o.title,30)))]),t._v(" "),o.title.length>30?e("a",{staticClass:"text-primary",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.toggleReadMore(o,"title")}}},[t._v("Read More")]):t._e()]),t._v(" "),e("td",{staticClass:"text-left"},[o.isDescriptionExpanded?e("span",[t._v(t._s(o.main_subject))]):e("span",[t._v(t._s(t.truncateText(o.main_subject,50)))]),t._v(" "),o.main_subject.length>50?e("a",{staticClass:"text-primary",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.toggleReadMore(o,"description")}}},[t._v("Read More")]):t._e()]),t._v(" "),e("td",{staticClass:"text-left"},[t._v(t._s(o.author_name))]),t._v(" "),e("td",{staticClass:"text-left"},[t._v(t._s(o.book_number))]),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(t.formatDate(o.publisher_date)))]),t._v(" "),e("td",{staticClass:"text-center"},[t._v(t._s(o.DownloadPin))]),t._v(" "),e("td",{staticClass:"d-flex justify-content-center flex-wrap gap-1"},[o.file_attachment_pdf?e("button",{staticClass:"btn btn-sm btn-info mx-1",on:{click:function(e){return t.openDownloadModal(o.id,"pdf")}}},[e("i",{staticClass:"fas fa-download"}),t._v(" PDF\n                ")]):t._e(),t._v(" "),o.file_attachment_epub?e("button",{staticClass:"btn btn-sm btn-info mx-1",on:{click:function(e){return t.openDownloadModal(o.id,"epub")}}},[e("i",{staticClass:"fas fa-download"}),t._v(" EPUB\n                ")]):t._e(),t._v(" "),o.file_attachment_txt?e("button",{staticClass:"btn btn-sm btn-info mx-1",on:{click:function(e){return t.openDownloadModal(o.id,"txt")}}},[e("i",{staticClass:"fas fa-download"}),t._v(" TXT\n                ")]):t._e(),t._v(" "),o.file_attachment_pdf||o.file_attachment_epub||o.file_attachment_txt?t._e():e("span",{staticClass:"text-muted"},[t._v("No Files")])]),t._v(" "),e("td",{staticClass:"text-center"},[e("div",{staticStyle:{display:"flex",gap:"10px","justify-content":"center"}},[e("button",{staticClass:"btn btn-sm btn-warning",on:{click:function(e){return t.editBook(o)}}},[e("i",{staticClass:"fas fa-edit"}),t._v(" Edit\n                  ")]),t._v(" "),e("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(e){return t.deleteBook(o.id)}}},[e("i",{staticClass:"fas fa-trash-alt"}),t._v(" Del\n                  ")])])])])})),0)])])])]),t._v(" "),t.showModal?e("div",{staticClass:"modal",staticStyle:{display:"block"}},[e("div",{staticClass:"modal-dialog modal-dialog-scrollable",staticStyle:{"max-width":"90%",width:"auto"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("Edit Book")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.closeModal}},[e("span",[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.updateBook.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"title"}},[t._v("Title")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.title,expression:"selectedBook.title"}],staticClass:"form-control",attrs:{type:"text",id:"title",required:""},domProps:{value:t.selectedBook.title},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"title",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"description"}},[t._v("Description")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.main_subject,expression:"selectedBook.main_subject"}],staticClass:"form-control",attrs:{id:"description",required:""},domProps:{value:t.selectedBook.main_subject},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"main_subject",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"book-number"}},[t._v("Book Number")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.book_number,expression:"selectedBook.book_number"}],staticClass:"form-control",attrs:{type:"text",id:"book-number",required:""},domProps:{value:t.selectedBook.book_number},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"book_number",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"author"}},[t._v("Author")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.author_name,expression:"selectedBook.author_name"}],staticClass:"form-control",attrs:{type:"text",id:"author",required:""},domProps:{value:t.selectedBook.author_name},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"author_name",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"publisher-date"}},[t._v("Publisher Date")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.publisher_date,expression:"selectedBook.publisher_date"}],staticClass:"form-control",attrs:{type:"date",id:"publisher-date",required:""},domProps:{value:t.selectedBook.publisher_date},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"publisher_date",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"download-pin"}},[t._v("Download Pin")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedBook.DownloadPin,expression:"selectedBook.DownloadPin"}],staticClass:"form-control",attrs:{type:"text",id:"download-pin",required:""},domProps:{value:t.selectedBook.DownloadPin},on:{input:function(e){e.target.composing||t.$set(t.selectedBook,"DownloadPin",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"cover-image"}},[t._v("Cover Image")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"file",id:"cover-image",accept:"image/*"},on:{change:t.handleCoverImageChange}}),t._v(" "),t.selectedBook.cover_image?e("p",[t._v("Current: "),e("img",{attrs:{src:t.selectedBook.cover_image,alt:"Current Cover",width:"50"}})]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"file-attachment-pdf"}},[t._v("PDF Attachment")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"file",id:"file-attachment-pdf",accept:".pdf"},on:{change:function(e){return t.handleFileChange(e,"pdf")}}}),t._v(" "),t.selectedBook.file_attachment_pdf?e("p",[t._v("Current: "),e("a",{attrs:{href:t.selectedBook.file_attachment_pdf,target:"_blank"}},[t._v("PDF File")])]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"file-attachment-epub"}},[t._v("EPUB Attachment")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"file",id:"file-attachment-epub",accept:".epub"},on:{change:function(e){return t.handleFileChange(e,"epub")}}}),t._v(" "),t.selectedBook.file_attachment_epub?e("p",[t._v("Current: "),e("a",{attrs:{href:t.selectedBook.file_attachment_epub,target:"_blank"}},[t._v("EPUB File")])]):t._e()]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"file-attachment-txt"}},[t._v("TXT Attachment")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"file",id:"file-attachment-txt",accept:".txt"},on:{change:function(e){return t.handleFileChange(e,"txt")}}}),t._v(" "),t.selectedBook.file_attachment_txt?e("p",[t._v("Current: "),e("a",{attrs:{href:t.selectedBook.file_attachment_txt,target:"_blank"}},[t._v("TXT File")])]):t._e()]),t._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("Update Book")])])])])])]):t._e(),t._v(" "),t.showDownloadModal?e("div",{staticClass:"modal",staticStyle:{display:"block"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("Enter Download PIN")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.closeDownloadModal}},[e("span",[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"download-pin"}},[t._v("PIN")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.downloadPin,expression:"downloadPin"}],staticClass:"form-control",attrs:{type:"text",id:"download-pin",required:""},domProps:{value:t.downloadPin},on:{input:function(e){e.target.composing||(t.downloadPin=e.target.value)}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary",on:{click:t.downloadBook}},[t._v("Download")])])])])]):t._e()])}),[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Image")]),t._v(" "),e("th",{staticClass:"text-left",attrs:{scope:"col"}},[t._v("Title")]),t._v(" "),e("th",{staticClass:"text-left",attrs:{scope:"col"}},[t._v("Description")]),t._v(" "),e("th",{staticClass:"text-left",attrs:{scope:"col"}},[t._v("Author")]),t._v(" "),e("th",{staticClass:"text-left",attrs:{scope:"col"}},[t._v("Book#")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Publish at")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Download Pin")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Downloads")]),t._v(" "),e("th",{staticClass:"text-center",attrs:{scope:"col"}},[t._v("Action")])])])}],!1,null,"11a97ed0",null);e.default=component.exports},683:function(t,e,o){var content=o(771);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(8).default)("12f9c220",content,!0,{sourceMap:!1})},769:function(t,e,o){"use strict";var n=o(12),r=o(66)(6),l="findIndex",c=!0;l in[]&&Array(1)[l]((function(){c=!1})),n(n.P+n.F*c,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o(104)(l)},770:function(t,e,o){"use strict";o(683)},771:function(t,e,o){var n=o(7)((function(i){return i[1]}));n.push([t.i,".gap-1[data-v-11a97ed0]{gap:.25rem}",""]),n.locals={},t.exports=n}}]);